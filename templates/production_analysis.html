{% extends "base.html" %}

{% block title %}{{ t['production_analysis'] }} - Mango DPP{% endblock %}

{% block content %}
<div class="mb-6 md:mb-8">
    <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
        <div>
            <h1 class="text-2xl md:text-3xl font-bold text-gray-900 mb-2">
                <i class="fas fa-industry text-navy mr-2 md:mr-3"></i>
                <span class="block md:inline">{{ t['production_location_analysis'] }}</span>
            </h1>
            <p class="text-sm md:text-base text-gray-600">{{ t['production_carbon_evaluation'] }}</p>
        </div>
        <a href="/sustainability" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors self-start md:self-auto">
            <i class="fas fa-arrow-left mr-2"></i>
            {{ t['back'] }}
        </a>
    </div>
</div>

<!-- En İyi ve En Kötü Lokasyonlar -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
    <!-- En İyi Lokasyonlar -->
    <div class="bg-white rounded-lg shadow-md p-4 md:p-6">
        <h2 class="text-lg md:text-xl font-semibold text-gray-900 mb-4">
            <i class="fas fa-star text-primary mr-2"></i>
            {{ t['lowest_carbon_locations'] }}
        </h2>
        
        <div class="space-y-3">
            {% for location, stats in best_locations %}
            <div class="bg-primary-light border border-primary rounded-lg p-3 md:p-4">
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-3 gap-2">
                    <h3 class="font-semibold text-gray-900 flex items-center text-sm md:text-base">
                        <i class="fas fa-map-marker-alt text-primary mr-2"></i>
                        {{ location }}
                    </h3>
                    <span class="bg-primary text-white text-xs px-2 py-1 rounded-full self-start">
                        {{ stats.avg_carbon }} kg CO₂
                    </span>
                </div>
                
                <div class="grid grid-cols-2 gap-2 text-xs md:text-sm">
                    <div class="flex justify-between">
                        <span class="text-gray-600">Mesafe:</span>
                        <span class="text-gray-900">{{ stats.distance_km if stats.distance_km is defined else 'N/A' }} km</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Taşıma:</span>
                        <span class="text-gray-900">{{ stats.transport_emission if stats.transport_emission is defined else 'N/A' }} kg CO₂</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">İşçi:</span>
                        <span class="text-gray-900">{{ stats.workforce if stats.workforce is defined else stats.count }} kişi</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Verimlilik:</span>
                        <span class="text-primary font-semibold">{{ stats.efficiency_score if stats.efficiency_score is defined else '75' }}%</span>
                    </div>
                </div>
                
                {% if stats.certifications is defined %}
                <div class="mt-3 pt-3 border-t border-primary">
                    <div class="flex flex-wrap gap-1">
                        {% for cert in stats.certifications %}
                        <span class="bg-primary text-white text-xs px-2 py-1 rounded">{{ cert }}</span>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- En Yüksek Karbon Lokasyonları -->
    <div class="bg-white rounded-lg shadow-md p-4 md:p-6">
        <h2 class="text-lg md:text-xl font-semibold text-gray-900 mb-4">
            <i class="fas fa-exclamation-triangle text-secondary mr-2"></i>
            İyileştirme Gereken Lokasyonlar
        </h2>
        
        <div class="space-y-3">
            {% for location, stats in worst_locations %}
            <div class="bg-secondary-light border border-secondary rounded-lg p-3 md:p-4">
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-3 gap-2">
                    <h3 class="font-semibold text-gray-900 flex items-center text-sm md:text-base">
                        <i class="fas fa-map-marker-alt text-secondary mr-2"></i>
                        {{ location }}
                    </h3>
                    <span class="bg-secondary text-white text-xs px-2 py-1 rounded-full self-start">
                        {{ stats.avg_carbon }} kg CO₂
                    </span>
                </div>
                
                <div class="grid grid-cols-2 gap-2 text-xs md:text-sm">
                    <div class="flex justify-between">
                        <span class="text-gray-600">Mesafe:</span>
                        <span class="text-gray-900">{{ stats.distance_km if stats.distance_km is defined else 'N/A' }} km</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Taşıma:</span>
                        <span class="text-secondary font-semibold">{{ stats.transport_emission if stats.transport_emission is defined else 'N/A' }} kg CO₂</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">İşçi:</span>
                        <span class="text-gray-900">{{ stats.workforce if stats.workforce is defined else stats.count }} kişi</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Verimlilik:</span>
                        <span class="text-secondary font-semibold">{{ stats.efficiency_score if stats.efficiency_score is defined else '60' }}%</span>
                    </div>
                </div>
                
                {% if stats.certifications is defined %}
                <div class="mt-3 pt-3 border-t border-secondary">
                    <div class="flex flex-wrap gap-1">
                        {% for cert in stats.certifications %}
                        <span class="bg-secondary text-white text-xs px-2 py-1 rounded">{{ cert }}</span>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<!-- Detaylı Lokasyon Analizi -->
<div class="bg-white rounded-lg shadow-md p-4 md:p-6 mb-8">
    <h2 class="text-lg md:text-xl font-semibold text-gray-900 mb-4">
        <i class="fas fa-globe text-navy mr-2"></i>
        {{ t['all_production_locations'] }}
    </h2>
    
    <div class="overflow-x-auto">
        <table class="min-w-full">
            <thead class="bg-gray-50">
                <tr>
                    <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Lokasyon</th>
                    <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ortalama CO₂</th>
                    <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mesafe</th>
                    <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Enerji</th>
                    <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Verimlilik</th>
                </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
                {% for location, stats in location_stats.items() %}
                <tr class="hover:bg-gray-50">
                    <td class="px-3 py-2 whitespace-nowrap">
                        <div class="flex items-center">
                            <i class="fas fa-map-marker-alt 
                                {% if stats.avg_carbon < 5 %}text-primary
                                {% elif stats.avg_carbon <= 7 %}text-navy
                                {% else %}text-secondary{% endif %} mr-2"></i>
                            <div>
                                <div class="text-sm font-medium text-gray-900">{{ location }}</div>
                                <div class="text-xs text-gray-500">{{ stats.count }} stil</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-3 py-2 whitespace-nowrap">
                        <div class="text-sm font-semibold 
                            {% if stats.avg_carbon < 5 %}text-primary
                            {% elif stats.avg_carbon <= 7 %}text-navy
                            {% else %}text-secondary{% endif %}">
                            {{ stats.avg_carbon }} kg
                        </div>
                    </td>
                    <td class="px-3 py-2 whitespace-nowrap text-sm text-gray-900">
                        {{ stats.distance_km if stats.distance_km is defined else 'N/A' }} km
                    </td>
                    <td class="px-3 py-2 whitespace-nowrap">
                        <div class="text-xs text-gray-600">
                            {{ stats.energy_source if stats.energy_source is defined else 'Şebeke Elektriği' }}
                        </div>
                    </td>
                    <td class="px-3 py-2 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="text-sm font-medium text-gray-900">{{ stats.efficiency_score if stats.efficiency_score is defined else '75' }}%</div>
                            <div class="ml-2 w-16 bg-gray-200 rounded-full h-2">
                                <div class="h-2 rounded-full 
                                    {% if (stats.efficiency_score if stats.efficiency_score is defined else 75) >= 80 %}bg-primary
                                    {% elif (stats.efficiency_score if stats.efficiency_score is defined else 75) >= 60 %}bg-navy
                                    {% else %}bg-secondary{% endif %}" 
                                    style="width: {{ stats.efficiency_score if stats.efficiency_score is defined else 75 }}%"></div>
                            </div>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<!-- Karbon Azaltım Önerileri -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
    <!-- Kısa Vadeli Aksiyonlar -->
    <div class="bg-white rounded-lg shadow-md p-4 md:p-6">
        <h2 class="text-lg md:text-xl font-semibold text-gray-900 mb-4">
            <i class="fas fa-clock text-primary mr-2"></i>
            {{ t['short_term_actions'] }}
        </h2>
        
        <div class="space-y-4">
            <div class="flex items-start">
                <div class="p-2 bg-primary-light rounded-full mr-3">
                    <i class="fas fa-shipping-fast text-primary text-sm"></i>
                </div>
                <div>
                    <h3 class="font-semibold text-gray-900 text-sm">Yakın Lokasyon Önceliği</h3>
                    <p class="text-xs text-gray-600 mt-1">Türkiye içi üretimi %25 artırarak taşıma emisyonlarını azaltın.</p>
                    <div class="mt-2 text-xs text-primary font-semibold">Potansiyel Azaltım: 15-20%</div>
                </div>
            </div>
            
            <div class="flex items-start">
                <div class="p-2 bg-navy-light rounded-full mr-3">
                    <i class="fas fa-route text-navy text-sm"></i>
                </div>
                <div>
                    <h3 class="font-semibold text-gray-900 text-sm">Optimize Lojistik</h3>
                    <p class="text-xs text-gray-600 mt-1">Konsolidasyon ile çoklu sevkiyatları birleştirin.</p>
                    <div class="mt-2 text-xs text-navy font-semibold">Potansiyel Azaltım: 10-15%</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Uzun Vadeli Hedefler -->
    <div class="bg-white rounded-lg shadow-md p-4 md:p-6">
        <h2 class="text-lg md:text-xl font-semibold text-gray-900 mb-4">
            <i class="fas fa-calendar-alt text-secondary mr-2"></i>
            {{ t['long_term_goals'] }}
        </h2>
        
        <div class="space-y-4">
            <div class="flex items-start">
                <div class="p-2 bg-secondary-light rounded-full mr-3">
                    <i class="fas fa-solar-panel text-secondary text-sm"></i>
                </div>
                <div>
                    <h3 class="font-semibold text-gray-900 text-sm">Yenilenebilir Enerji</h3>
                    <p class="text-xs text-gray-600 mt-1">Üretici partnerlerin güneş enerjisi yatırımını destekleyin.</p>
                    <div class="mt-2 text-xs text-secondary font-semibold">Potansiyel Azaltım: 30-40%</div>
                </div>
            </div>
            
            <div class="flex items-start">
                <div class="p-2 bg-primary-light rounded-full mr-3">
                    <i class="fas fa-certificate text-primary text-sm"></i>
                </div>
                <div>
                    <h3 class="font-semibold text-gray-900 text-sm">Sertifikasyon Programı</h3>
                    <p class="text-xs text-gray-600 mt-1">Tüm üreticilerin ISO 14001 sertifikasyonu almasını sağlayın.</p>
                    <div class="mt-2 text-xs text-primary font-semibold">Sürdürülebilirlik Artışı: 25%</div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Karbon Emisyon Trendleri -->
<div class="bg-white rounded-lg shadow-md p-4 md:p-6">
    <h2 class="text-lg md:text-xl font-semibold text-gray-900 mb-4">
        <i class="fas fa-chart-line text-navy mr-2"></i>
        Karbon Emisyon Karşılaştırması
    </h2>
    
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
        <div class="text-center p-3 bg-primary-light rounded-lg">
            <div class="text-xl md:text-2xl font-bold text-primary mb-1">4.1</div>
            <p class="text-xs text-primary">Türkiye Ort.</p>
            <p class="text-xs text-gray-600">kg CO₂</p>
        </div>
        
        <div class="text-center p-3 bg-navy-light rounded-lg">
            <div class="text-xl md:text-2xl font-bold text-navy mb-1">6.8</div>
            <p class="text-xs text-navy">Avrupa Ort.</p>
            <p class="text-xs text-gray-600">kg CO₂</p>
        </div>
        
        <div class="text-center p-3 bg-secondary-light rounded-lg">
            <div class="text-xl md:text-2xl font-bold text-secondary mb-1">8.5</div>
            <p class="text-xs text-secondary">Asya Ort.</p>
            <p class="text-xs text-gray-600">kg CO₂</p>
        </div>
        
        <div class="text-center p-3 bg-gray-100 rounded-lg">
            <div class="text-xl md:text-2xl font-bold text-gray-700 mb-1">3.2</div>
            <p class="text-xs text-gray-700">Hedef 2025</p>
            <p class="text-xs text-gray-600">kg CO₂</p>
        </div>
    </div>
</div>

{% endblock %}